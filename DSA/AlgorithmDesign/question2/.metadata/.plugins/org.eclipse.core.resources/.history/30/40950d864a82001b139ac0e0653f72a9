package org.get.employeeSort;

public class Sort {
	/**
	 * 
	 * @param l list to be sorted
	 * @return sorted list based on employee salary and age
	 */
	public LinkedList sort(LinkedList l){
		if(l.getHead().getNext() == null){
			return l;
		}
		Node i = l.getHead();
		while(i.getNext() != null){
			Node j = i.getNext();
			System.out.println("Sort:" + j.getEmployee().getName());
			Node currentNode = i;
			while(j.getPrev() != null && j.getEmployee().getSalary()
					> currentNode.getEmployee().getSalary()){
					j = j.getPrev();
			}
			System.out.println("Sort1:" + j.getNext().getEmployee().getName());
			if(j.getPrev() == null && j.getEmployee().getSalary()
					< currentNode.getEmployee().getSalary()){
				i = i.getNext();
				continue;
			}
			if(j.getEmployee().getSalary() == currentNode.getEmployee().getSalary()){
				if(j.getEmployee().getAge() > currentNode.getEmployee().getAge()){
					Node temp = currentNode;
					if(j.getPrev() != null){
						i.setPrev(j.getPrev());
						i.setNext(j.getNext());
					}
					else {
						i.setPrev(null);
						i.setNext(j.getNext());
						if(temp.getNext() != null){
							j.setNext(temp.getNext());
							j.setPrev(temp.getPrev());
						}
						else{
							j.setNext(null);
							j.setPrev(temp.getPrev());
						}
						l.setHead(i);
					}
				}
				else if(j.getEmployee().getAge() <= currentNode.getEmployee().getAge()){
					Node temp = currentNode;
					j = j.getNext();
					if(j.getPrev() != null){
						currentNode.setPrev(j.getPrev());
						currentNode.setNext(j.getNext());
					}
					else {
						currentNode.setPrev(null);
						currentNode.setNext(j.getNext());
					}
					if(temp.getNext() != null){
						j.setNext(temp.getNext());
						j.setPrev(temp.getPrev());
					}
					else{
						j.setNext(null);
						j.setPrev(temp.getPrev());
					}
				}
				else {
					Node temp = currentNode;
					if(j.getPrev() == null){
						currentNode.setPrev(null);
						currentNode.setNext(j.getNext());
						l.setHead(currentNode);
					}
					else {
						j = j.getNext();
						currentNode.setPrev(j.getPrev());
						currentNode.setNext(j.getNext());
					}
					if(temp.getNext() != null){
						j.setNext(temp.getNext());
						j.setPrev(temp.getPrev());
					}
					else{
						j.setNext(null);
						j.setPrev(temp.getPrev());
					}
				}
			}
			i = i.getNext();
		}
		return l;
	}
	
}
